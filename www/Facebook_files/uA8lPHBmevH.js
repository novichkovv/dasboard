/*!CK:1407478714!*//*1460973697,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["oS3i7"]); }

__d("XFeedNUXSaveSeenStateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/feed\/nux\/seen\/save\/",{link_id:{type:"String"},key:{type:"String",required:true},seen:{type:"Bool",defaultValue:false},env:{type:"Enum",enumType:0}});},null);
__d('MFeedNUXTooltip',['DOM','MRequest','MViewport','Stratcom','SubscriptionsHandler','XFeedNUXSaveSeenStateController','destroyOnUnload','mixInEventEmitter'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p={},q,r={},s,t=0,u=100,v=1,w=0;function x(){q=k.listen('scroll',null,z);n(y);}function y(){if(q)q.remove();q=null;window.clearTimeout(s);s=null;}function z(){var ca=j.getHeight();if(s){window.clearTimeout(s);s=null;}for(var da in p){var ea=p[da],fa=ea.getNodes(),ga=ea.getHeadRoom();for(var ha=0;ha<fa.length;ha++){var ia=fa[ha].getBoundingClientRect();if(ia.top>=ga&&ia.bottom<=ca){aa(fa[ha],ea);break;}}}}function aa(ca,da){s=window.setTimeout(function(){if(da.getContext()!==ca){da.setContext(ca);da.show();}},t);}function ba(ca,da,ea,fa){'use strict';if(!p.length)x();if(p[da]||r[da]){ea.destroy();return;}this.$MFeedNUXTooltip1=da;this.$MFeedNUXTooltip2=h.scry(document.getElementById('page'),'*',ca);this.$MFeedNUXTooltip3=ca;this.$MFeedNUXTooltip4=w;this.$MFeedNUXTooltip5=ea;this.$MFeedNUXTooltip6=fa===0?0:fa||u;p[da]=this;var ga=new l();ga.addSubscriptions(this.$MFeedNUXTooltip5.addListener('show',this.emit.bind(this,'show')),this.$MFeedNUXTooltip5.addListener('hide',function(){this.emit('hide');ga.release();}.bind(this)));z();}ba.prototype.destroy=function(){'use strict';delete p[this.$MFeedNUXTooltip1];if(!Object.keys(p).length)y();};ba.prototype.getContext=function(){'use strict';return this.$MFeedNUXTooltip5.getContext();};ba.prototype.getNodes=function(){'use strict';return this.$MFeedNUXTooltip2;};ba.prototype.getHeadRoom=function(){'use strict';return this.$MFeedNUXTooltip6;};ba.prototype.getIsUnseen=function(){'use strict';return this.$MFeedNUXTooltip4===w;};ba.prototype.setContext=function(ca){'use strict';this.$MFeedNUXTooltip5&&this.$MFeedNUXTooltip5.setContext(ca);};ba.prototype.show=function(){'use strict';if(!this.$MFeedNUXTooltip5||this.$MFeedNUXTooltip4===v)return;r[this.$MFeedNUXTooltip1]=true;this.$MFeedNUXTooltip4=v;this.$MFeedNUXTooltip5.show();var ca=m.getURIBuilder().setString('key',this.$MFeedNUXTooltip1).setBool('seen',true);new i(ca.getURI()).setMethod('POST').send();this.destroy();};ba.prototype.hide=function(){'use strict';this.$MFeedNUXTooltip5&&this.$MFeedNUXTooltip5.hide();};o(ba,{show:true,hide:true});f.exports=ba;},null);
__d('MFeedReactionsNUX',['BanzaiLogger','MLegacyDataStore','MLiveData','Stratcom','SubscriptionsHandler','requestAnimationFrame'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();function n(p){if(p){var q=new l();q.addSubscriptions(k.listen('click','like-reaction-flyout',function(r){var s=r.getNode('feed-ufi-metadata'),t=i.get(s).feedback_target.toString(),u=j.get(t);q.addSubscriptions(u.listen('change',function(){if(u.getData().has_viewer_liked)m(function(){p.setContext(r.getTarget());p.show();o(t);});}));}),k.listen('click','reactions-bling-bar',function(r){var s=r.getNode('mufi-inline').querySelector('a[data-sigil*="like-reaction-flyout"]');if(s){var t=r.getNode('feed-ufi-metadata'),u=i.get(t).feedback_target.toString();o(u);p.setContext(s);p.show();r.kill();}}),p.once('hide',function(){q.release();}));k.listen('m:page:unload',null,function(){k.removeCurrentListener();q.release();});}}function o(p){h.log('WebReactionsNuxLoggerConfig',{feedback_id:p,'interface':'mTouch'});}f.exports.init=n;},null);
__d("XFeedUFICommentHistoryController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/feed\/ufi\/{comment_token}\/history\/",{comment_token:{type:"String",required:true},replace_id:{type:"String",required:true}});},null);
__d("XFeedUFICommentsController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/feed\/ufi\/",{fs:{type:"Int"},feedback_target:{type:"String",required:true},focus_composer:{type:"Bool",defaultValue:false},replace_id:{type:"String",required:true},share_id:{type:"String"},link_data:{type:"String"},action_source:{type:"Int"}});},null);
__d("XFeedUFILikesController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/feed\/ufi\/likes\/",{feedback_target:{type:"String",required:true},replace_id:{type:"String",required:true},link_data:{type:"String"}});},null);
__d("XFeedUFIReactionsController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/feed\/ufi\/reactions\/",{feedback_target:{type:"String",required:true},replace_id:{type:"String",required:true},link_data:{type:"String"}});},null);
__d('MFeedUFI',['$','ActorURI','CSS','MLegacyDataStore','DOM','MParent','MJSEnvironment','MRequest','MViewport','Stratcom','Vector','XFeedUFICommentsController','XFeedUFICommentHistoryController','XFeedUFILikesController','XFeedUFIReactionsController','cx','ge','getActiveElement','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){if(c.__markCompiled)c.__markCompiled();var aa='feed-ufi',ba='replies-see-more',ca={COMMENTS:'comments',LIKES:'likes',REACTIONS:'reactions',HISTORY:'history',NONE:''},da="_1vcf",ea="_53xw",fa,ga,ha,ia,ja,ka,la,ma,na,oa=null,pa=null,qa=null;function ra(){if(qa){j.removeClass(qa,da);qa=null;}}function sa(jc){ra();if(jc){j.addClass(jc,da);qa=jc;}}var ta=null;function ua(){if(ta){j.removeClass(ta,ea);ta=null;}}function va(jc){ua();if(jc){j.addClass(jc,ea);ta=jc;}}function wa(){if(ka)return;la=[q.listen('click',[aa,'composer-submit'],xb),q.listen('click','like',ub),q.listen('focus',[aa,'textarea'],rb),q.listen('multi-photos-change',null,yb),q.listen('MCommentEdit:showcomposer',null,zb),q.listen('MUFICommentReplyLink:show-inline-composer',null,ac),q.listen('MStickerSelector:show-sticker-selector',null,bc),q.listen('m:page:unload',null,db)];if(n.IS_APPLE_WEBKIT_IOS)la.push(q.listen('focus',[aa,'editCommentTextArea'],tb));ka=true;}function xa(){if(!ja)return;l.find(ja,'*','textarea').blur();}function ya(){if(!ja)return;l.find(ja,'*','textarea').focus();}function za(){if(!ja)return;var jc=l.find(ja,'*','textarea');if(y()===jc)p.scrollTo(0,r.getPos(jc).y+jc.offsetHeight-p.getScreenHeight());}function ab(jc){if(!jc)return;var kc=bb(),lc=jc.offsetTop,mc=jc.offsetHeight,nc=lc+mc,oc=kc.getScrollTop(),pc=kc.getScrollHeight(),qc=oc+pc;if(lc<oc||nc>qc)if(lc<oc||mc>pc){ec(Math.max(0,lc));}else ec(Math.max(0,oc+(nc-qc)));}function bb(){return k.get(ia).scrollArea;}function cb(){if(!na)na=l.scry(document,'div',aa)[0];return na;}function db(){while(la.length)la.pop().remove();eb();ib();ra();fa=null;ga=null;ha=null;na=null;ka=false;}function eb(){if(!oa)return;while(oa.length)oa.pop().remove();oa=null;}function fb(jc,kc,lc,mc){ra();ua();hb(lc,mc);var nc=hc(jc);fc(false);if(nc===fa){if(kc)ya();gc(ca.COMMENTS);q.invoke('m:feed-ufi-flyout:comments-displayed');return;}fa=nc;var oc=l.find(cb(),'div','feed-ufi-comments').id,pc=s.getURIBuilder().setString('feedback_target',nc).setString('replace_id',oc).setBool('focus_composer',!!kc),qc=k.get(jc).feedback_source;if(qc)pc.setInt('fs',qc);var rc=k.get(jc).share_id;if(rc)pc.setString('share_id',rc.toString());var sc=k.get(jc).action_source;if(sc===undefined)sc=20;var tc=ic(jc);if(tc)pc.setString('link_data',tc);pc=pc.getURI();var uc=k.get(jc).actor_id;if(uc)pc=i.create(pc,uc);ma=new o(pc.toString());ma.listen('finally',function(){ma=null;});ma.send();}function gb(jc){var kc=x(jc+'');if(kc&&ia&&ia.contains(kc)){ec(kc.offsetTop);return kc;}return null;}function hb(jc,kc){ib();if(jc)pa=q.listen('m:feed-ufi-flyout:comments-displayed',null,function(){setTimeout(function(){var lc=!!gb(jc);if(!lc&&kc){var mc=gb(kc),nc=mc&&l.scry(mc,'*',ba)[0];if(nc)sa(nc);}});ib();});}function ib(){if(pa){pa.remove();pa=null;}}function jb(jc){var kc=hc(jc);fc(true);if(kc===ga){gc(ca.LIKES);return;}ga=kc;gc(ca.NONE);var lc=l.find(cb(),'div','feed-ufi-likes').id,mc=u.getURIBuilder().setString('feedback_target',kc).setString('replace_id',lc).getURI();ma=new o(mc.toString());ma.listen('finally',function(){ma=null;});ma.send();}function kb(jc){var kc=hc(jc);fc(true);if(kc===ha){gc(ca.REACTIONS);return;}ha=kc;gc(ca.NONE);var lc=l.find(cb(),'div','feed-ufi-reactions').id,mc=v.getURIBuilder().setString('feedback_target',kc).setString('replace_id',lc).getURI();ma=new o(mc.toString());ma.listen('finally',function(){ma=null;});ma.send();}function lb(jc){fc(true);gc(ca.NONE);var kc=l.find(cb(),'div','feed-ufi-comment-history').id,lc=t.getURIBuilder().setString('comment_token',jc).setString('replace_id',kc).getURI();ma=new o(lc.toString());ma.listen('finally',function(){ma=null;});ma.send();}function mb(){gc(ca.HISTORY);}function nb(){if(!ma)return;fa=null;ga=null;ma.abort();ma=null;}function ob(){fa=null;ga=null;}function pb(jc){var kc=hc(jc),lc=kc!==fa;gc(lc?ca.NONE:ca.COMMENTS);if(lc)q.invoke('m:feed-ufi-flyout:reset',null,{target_id:kc});}function qb(jc,kc){gc(ca.COMMENTS);ia=jc;ja=kc;q.invoke('m:feed-ufi-flyout:comments-displayed');}function rb(){sb();}function sb(){q.invoke('click','edit-link');}function tb(jc){if(oa)return;var kc=jc.getTarget();oa=[q.listen('MScrollArea:scrollend',null,function(){var lc=kc.selectionStart,mc=kc.selectionEnd;kc.setSelectionRange(Math.abs(lc-1),Math.abs(mc-1));kc.setSelectionRange(lc,mc);}),q.listen('blur',[aa,'editCommentTextArea'],function(){eb();})];}function ub(){ga=null;}function vb(jc){gc(ca.LIKES);}function wb(jc){gc(ca.REACTIONS);}function xb(event){var jc=event.getNode('m-inline-reply-composer');if(jc)return;var kc=cb();z(function(){var lc=l.find(kc,'div','feed-ufi-composer-placeholder');ec(lc.offsetTop);},0);j.conditionClass(l.find(kc,'div','feed-ufi-comments'),"_5jc2",true);}function yb(){if(!ja)return;var jc=cb();if(jc)j.conditionClass(cb(),"_5rpd",l.scry(ja,'input','m-multi-photos-photo').length);}function zb(jc){ec(jc.getData().composer.offsetTop);}function ac(jc){sb();var kc=jc.getData(),lc=kc.composerRoot;if(lc){ab(lc);ua();setTimeout(function(){va(lc);},0);}}function bc(jc){var kc=jc.getData(),lc=kc.selectorNode;ab(lc);}function cc(jc){q.invoke('m:feed-ufi-flyout:comment-change');ec(h(jc).offsetTop);}function dc(){q.invoke('m:feed-ufi-flyout:comment-change');var jc=cb();if(l.scry(jc,'div','comment').length){bb().reflow();}else j.conditionClass(l.find(jc,'div','feed-ufi-comments'),"_5jc2",false);}function ec(jc){if(!ia)return;var kc=bb();kc.reflow();z(function(){var lc=kc.getMaxScrollTop();if(jc!==undefined)lc=Math.min(jc,lc);kc.scrollTo(0,lc);},100);}function fc(jc){var kc=cb();if(kc)j.conditionClass(kc,"_5sd3",jc);}function gc(jc){var kc=cb();if(kc){j.conditionClass(kc,"_5m_y",jc==ca.COMMENTS);j.conditionClass(kc,"_5m_z",jc==ca.LIKES);j.conditionClass(kc,"_3b5-",jc==ca.REACTIONS);j.conditionClass(kc,"_5ugy",jc==ca.HISTORY);}}function hc(jc){return k.get(jc).feedback_target.toString();}function ic(jc){var kc=m.bySigil(jc,'story-div');if(!kc)return;var lc=k.get(kc).linkdata;if(lc)return lc.toString();return null;}g.blur=xa;g.cancel=nb;g.clearCache=ob;g.focus=ya;g.getRoot=cb;g.init=wa;g.loadComments=fb;g.loadLikes=jb;g.loadReactions=kb;g.loadCommentHistory=lb;g.onCommentHistoryLoad=mb;g.onCommentAdded=cc;g.onCommentRemoved=dc;g.onCommentsLoad=qb;g.onLikesLoad=vb;g.onReactionsLoad=wb;g.reset=pb;g.scrollTo=za;},null);
__d('MCommentEdit',['$','cx','ge','CSS','MLegacyDataStore','DOM','MRequest','Stratcom','URI'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q=[];function r(da){m.hide(h(da));}function s(da){var ea=document.getElementById('photo-composer-'+da);if(ea==null)ea=document.getElementById('composer-'+da);return ea;}function t(da){var ea=s(da);ea&&m.hide(ea);}function u(da){var ea=s(da);ea&&m.show(ea);}function v(da,ea,fa){q.push(m.listen(h(da),'click',null,function(ga){y(ea,fa);this.remove();}));}function w(da,ea){function fa(){var ga=da.querySelector('textarea').value,ha=ga.length===0;ea.disabled=ha;k.conditionClass(ea,"_56bt",ha);k.conditionClass(ea,"_56bu",!ha);}fa();q.push(m.listen(da,'keyup',null,fa));}function x(da){q.push(o.listen('click','edit-link',function(ea){var fa=document.getElementById(da);ca(da);if(fa)m.show(fa);this.remove();}));}function y(da,ea){m.show(h(da));u(ea);ca(da);}var z;function aa(da){da.kill();var ea=l.get(da.getTarget());new n(new p(ea.deleteUri)).send();}function ba(da){if(!z)z=o.listen('click','comment-edit-delete-link',aa);r(da.domContainerId);t(da.entId);o.invoke('MCommentEdit:showcomposer',null,{composer:document.getElementById(da.commentComposerId),entId:da.entId,domContainerId:da.domContainerId});}function ca(da){var ea=j('commentEditComposer'+da);if(ea)m.remove(ea);for(var fa=0;fa<q.length;fa++)q[fa].remove();q=[];}g.showComposer=u;g.showCommentEditor=ba;g.removeEditComposer=ca;g.listenForCancel=v;g.listenForEmptyInput=w;g.listenForOtherEdit=x;g.cancelEdit=y;},null);
__d('MFeedUFIOverlay',['MLegacyDataStore','MFeedUFI','MHistory','MJSEnvironment','MParent','MViewport','MScrollPositionSaver','MCommentEdit','Stratcom','URI','getActiveElement'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();var s='feed_ufi',t='comment_token',u='comments',v='likes',w='reactions',x='comment-history',y='nfx',z=k.IS_ANDROID&&!k.IS_FIREFOX&&!k.IS_CHROME,aa,ba,ca,da=[],ea,fa,ga,ha,ia,ja,ka={};function la(hb){aa=hb;ca=[aa.addListener('beforeshow',qa),aa.addListener('hide',ra),aa.addListener('show',ta),p.listen('click','m-overlay-modal',sa),p.listen('click','feed-ufi-trigger',bb),p.listen('click','feed-ufi-back',va),p.listen('click','feed-ufi-done',wa),p.listen('click','feed-ufi-likers',db),p.listen('click','feed-ufi-reactors',eb),p.listen('click','feed-ufi-view-history',gb),p.listen('click','feed-ufi-nfx-dialog',cb),p.listen('m:history:change',null,ua),p.listen('m:page:unload',null,ma),p.listen('MCommentEdit:showcomposer',null,function(ib){ka.domContainerId=ib.getData().domContainerId;ka.entId=ib.getData().entId;})];ba=new q(j.getPath()).addQueryData(s,undefined).addQueryData(t,undefined).toString();j.replaceState(ba);}function ma(){while(ca.length)ca.pop().remove();na();}function na(){while(da.length)da.pop().remove();}function oa(){if(pa()===u){history.go(-1);}else history.go(-2);}function pa(){return j.getParam(s);}function qa(){i.reset(ha);ya();za();}function ra(){if(typeof ka.domContainerId!=='undefined'&&typeof ka.entId!=='undefined')o.cancelEdit(ka.domContainerId,ka.entId);clearTimeout(ga);i.cancel();i.blur();r().blur();na();n.setScrollPosition(ea);p.invoke('m:feed-ufi:hide',null,null);}function sa(hb){if(hb.getNode('m-layer-root')===aa.getRoot()&&aa.isShown())if(aa.getUpdatePositionBlocked()){i.blur();}else oa();}function ta(){if(da.length===0)da=[p.listen('scroll',null,ab),p.listen('m:viewport:orientation-change',null,xa)];p.invoke('m:feed-ufi:show',null,null);}function ua(hb){var ib=pa();if(ib){hb.prevent();if(!aa.isShown())aa.show();if(ib===u){i.loadComments(ha,false,ia,ja);ia=null;ja=null;}else if(ib===v){i.loadLikes(ha);}else if(ib===w){i.loadReactions(ha);}else if(ib===x){var jb=j.getParam(t);i.loadCommentHistory(jb);}else if(ib===y)ra();}else if(hb.getData().path!==ba){return;}else{hb.prevent();if(aa.isShown()){i.blur();aa.hide();}}}function va(hb){hb.prevent();history.go(-1);}function wa(hb){hb.prevent();oa();}function xa(hb){if(!z){i.blur();m.scrollTo(0,fa);}else{clearTimeout(ga);ga=setTimeout(function(){i.scrollTo();},500);}}function ya(){fa=m.getScrollTop();}function za(){ea=n.getScrollPosition();}function ab(hb){if(!m.getScrollTop()&&fa)oa();}function bb(hb){var ib=hb.getNode('feed-ufi-trigger');if(l.bySigil(ib,'disable-feed-ufi-triggers'))return;aa.setCausalElement(ib);h.get(ib).overlay=aa;ha=l.bySigil(ib,'feed-ufi-metadata');var jb=h.get(ib);ia=jb.comment_id;ja=jb.parent_id;ba=j.getPath();fb(u);hb.prevent();}function cb(hb){fb(y);hb.prevent();}function db(hb){fb(v);hb.prevent();}function eb(hb){fb(w);hb.prevent();}function fb(hb){var ib=new q(j.getPath()).addQueryData(s,hb).removeQueryData(t);j.pushState(ib.toString());}function gb(hb){var ib=h.get(hb.getNode('comment')).token;j.pushState(new q(j.getPath()).addQueryData(s,x).addQueryData(t,ib).toString());hb.prevent();}g.init=la;},null);
__d('MPagesStarsRatableBase',['CSS','MLegacyDataStore','DOM','Stratcom'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();function l(m,n,o){'use strict';this.root=m;this.stars=j.scry(m,'span','stars-ratable-star');this.hiddenInput=j.find(m,'input','stars-ratable-input');this.ratingTextContainer=o;this.listeners=[j.listen(this.root,'click','star-link',this._onClick.bind(this)),k.listen('MPagesStarsRatableBase-setStars',null,function(event){this.setRating(event.getData().rating);}.bind(this))];this.setRating(n);var p=this.listeners;k.listen('m:page:unload',null,function(){k.removeCurrentListener();p.forEach(function(q){q.remove();});});}l.prototype._onClick=function(event){'use strict';var m=this._getStarIndexFromEvent(event);if(m){this.setRating(m);k.invoke('MPagesStarsRatableBase-starTapped',null,{rating:m});}event.prevent();};l.prototype._getStarIndexFromEvent=function(event){'use strict';var m=event.getTarget();if(m.nodeName==="A")m=j.find(m,'span','stars-ratable-star');return this.stars.indexOf(m)+1;};l.prototype.setRating=function(m){'use strict';for(var n=0;n<this.stars.length;++n){var o=n>=m;h.conditionClass(this.stars[n],'fullStar',!o);h.conditionClass(this.stars[n],'emptyStar',o);}this.hiddenInput.value=m;if(m)if(this.ratingTextContainer)this.ratingTextContainer.textContent=i.get(this.stars[m-1]).tooltip;k.invoke('MPagesStarsRatableBase-starsSet',null,{rating:m});};l.init=function(m,n,o){'use strict';new l(m,n,o);};f.exports=l;},null);
__d('MSnowflakeLink',['DOM','MModalDialog','URI','MLinkHack','Parent','Stratcom','destroyOnUnload'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();function o(p){'use strict';this.$MSnowflakeLink1=false;this.$MSnowflakeLink2=p.node;this.$MSnowflakeLink3=p.permalink;this.$MSnowflakeLink4=p.setToken;this.$MSnowflakeLink5=p.targetPhoto;this.$MSnowflakeLink6=h.listen(p.node,'click',null,this.onClick.bind(this));n(function(){return this.$MSnowflakeLink6.remove();}.bind(this));this.$MSnowflakeLink7();}o.prototype.getFeedTrackingOwnerID=function(){'use strict';var p=l.byAttribute(this.$MSnowflakeLink2,'data-ft');return p&&p.id;};o.prototype.getPermalinkURI=function(){'use strict';return new j(this.$MSnowflakeLink3).addQueryData('photo_id',this.$MSnowflakeLink5);};o.prototype.getModalDialogURI=function(){'use strict';return new j(this.$MSnowflakeLink2.getAttribute('href')).addQueryData('cached_data',this.$MSnowflakeLink1).addQueryData('ftid',this.getFeedTrackingOwnerID());};o.prototype.onClick=function(p){'use strict';k.remove(this.$MSnowflakeLink2);i.openWithPermalinkURI(this.getModalDialogURI().toString(),this.getPermalinkURI());p.kill();};o.prototype.$MSnowflakeLink7=function(){'use strict';if(!this.$MSnowflakeLink4){this.$MSnowflakeLink1=true;return;}var p=m.listen('m:photosetstore:update',null,function(event){var q=(event.getData()||{}).set_token;if(!p||q!=this.$MSnowflakeLink4)return;this.$MSnowflakeLink1=true;p.remove();p=null;}.bind(this));n(function(){return p&&p.remove();});};f.exports=o;},null);
__d('MCurationCaretNux',['cx','destroyOnUnload','isNodeWithinRect','MLegacyDataStore','DOM','MRequest','MViewport','Parent','Stratcom'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q='show-save-caret-nux-on-click',r='flyout-causal',s='MCurationCaretNux_instance',t='more',u='close-save-caret-nux-on-click',v="_5rgr",w=500,x=100,y='LINK_WELCOME',z='POST_SAVE_WELCOME',aa='VIDEO_WELCOME',ba='VIDEO_SLOW_CONNECT',ca='seen',da='dismissed',ea=null,fa=[],ga=false,ha=false;function ia(ja,ka,la,ma,na,oa){'use strict';this.$MCurationCaretNux1=ja;this.$MCurationCaretNux2=ka;this.$MCurationCaretNux3=la;this.$MCurationCaretNux4=ma;this.$MCurationCaretNux5=na;this.$MCurationCaretNux6=oa;}ia.prototype.$MCurationCaretNux7=function(){'use strict';if(ga)return;ga=true;this.$MCurationCaretNux1.show();};ia.prototype.$MCurationCaretNux8=function(){'use strict';this.$MCurationCaretNux1.hide();this.$MCurationCaretNux9(da);};ia.prototype.$MCurationCaretNux10=function(){'use strict';this.$MCurationCaretNux11=0;this.$MCurationCaretNux12=Date.now();setTimeout(function(){if(!this.$MCurationCaretNux13())this.$MCurationCaretNux7();}.bind(this),this.$MCurationCaretNux2);setTimeout(function(){if(!this.$MCurationCaretNux13()){ga=false;this.$MCurationCaretNux1.hide();}}.bind(this),this.$MCurationCaretNux3);};ia.prototype.$MCurationCaretNux14=function(){'use strict';if(ga&&ha)return;this.$MCurationCaretNux11=Date.now()-this.$MCurationCaretNux12;if(this.$MCurationCaretNux15)window.clearTimeout(this.$MCurationCaretNux15);this.$MCurationCaretNux15=window.setTimeout(this.$MCurationCaretNux16.bind(this),w);};ia.prototype.$MCurationCaretNux16=function(){'use strict';var ja=ia.$MCurationCaretNux17();if(!this.$MCurationCaretNux1.isShown()){if(this.$MCurationCaretNux6!==ba)return;if(j(this.$MCurationCaretNux1.getContext(),ja))this.$MCurationCaretNux7();}else if(j(this.$MCurationCaretNux1.getContentRoot(),ja))this.$MCurationCaretNux9(ca);};ia.prototype.$MCurationCaretNux13=function(){'use strict';return this.$MCurationCaretNux11&&this.$MCurationCaretNux11>0;};ia.prototype.$MCurationCaretNux9=function(ja){'use strict';var ka=null;if(ja===ca){ka=this.$MCurationCaretNux4;this.seenURI=null;ha=true;}else if(ja===da){ka=this.$MCurationCaretNux5;this.dismissURI=null;}if(ka){var la=new m(ka);if(this.$MCurationCaretNux11)la.addData({interaction_time:this.$MCurationCaretNux11});la.setMethod('POST').send();}};ia.prototype.$MCurationCaretNux18=function(ja){'use strict';if(ja===ca){return this.seenURI===null;}else if(ja===da)return this.dismissURI===null;return false;};ia.register=function(ja,ka,la,ma,na,oa){'use strict';p.removeSigil(ja.getCausalElement(),r);var pa=new ia(ja,ka,la,ma,na,oa);fa.push(pa);var qa={};qa[s]=pa;var ra=ja.getContext();if(ra){var sa=o.byClass(ra,v);if(sa)k.set(sa,qa);}var ta=ja.getContentRoot();if(ta){var ua=l.scry(ta,'div',u);if(ua.length>0)ua.forEach(function(va){k.set(va,qa);});}ia.$MCurationCaretNux19();};ia.$MCurationCaretNux20=function(event){'use strict';var ja=event.getNode(q),ka=ia.$MCurationCaretNux21(ja);if(ka){var la=ka.$MCurationCaretNux6;if(la===y||la===aa)ka.$MCurationCaretNux10();}};ia.$MCurationCaretNux22=function(event){'use strict';var ja=event.getNode(t),ka=ia.$MCurationCaretNux21(ja);if(ka){var la=ka.$MCurationCaretNux6;if(la===z)ka.$MCurationCaretNux7();}};ia.$MCurationCaretNux23=function(event){'use strict';var ja=event.getTarget(),ka=ia.$MCurationCaretNux21(ja);if(ka&&ka.$MCurationCaretNux6===aa){ja.addEventListener('pause',ia.$MCurationCaretNux24);setInterval(function(){ja.removeEventListener('pause',ia.$MCurationCaretNux24);},ka.$MCurationCaretNux3);}};ia.$MCurationCaretNux24=function(event){'use strict';var ja=event.target,ka=ia.$MCurationCaretNux21(ja);ka&&ka.$MCurationCaretNux7();};ia.$MCurationCaretNux25=function(event){'use strict';var ja=event.getNode(u),ka=k.get(ja)[s];ka&&ka.$MCurationCaretNux8();};ia.$MCurationCaretNux14=function(event){'use strict';fa.forEach(function(ja){ja.$MCurationCaretNux14();});};ia.$MCurationCaretNux17=function(){'use strict';var ja=n.getHeight(),ka=n.getWidth();return {bottom:ja,height:ja-x,left:0,top:x,right:ka,width:ka};};ia.$MCurationCaretNux21=function(ja){'use strict';var ka=o.byClass(ja,v);while(ka){var la=k.get(ka)[s];if(la)return la;ka=o.byClass(ka.parentNode,v);}return null;};ia.$MCurationCaretNux19=function(){'use strict';if(ea)return null;ea=[p.listen('click',q,ia.$MCurationCaretNux20),p.listen('click',t,ia.$MCurationCaretNux22),p.listen('click',u,ia.$MCurationCaretNux25),p.listen('play',null,ia.$MCurationCaretNux23),p.listen('scroll',null,ia.$MCurationCaretNux14)];i(function(){while(ea.length)ea.pop().remove();ea=null;fa=[];});};f.exports=ia;},null);
__d('MOverlay',['setTimeoutAcrossTransitions','cx','ge','CSS','DOM','Locale','MLayer','MJSEnvironment','MViewport','Scroll','Stratcom','MTouchHelper'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t,u;if(c.__markCompiled)c.__markCompiled();var v=28,w=10,x='m-overlay-layer',y=[x,'tag:textarea'];t=babelHelpers.inherits(z,n);u=t&&t.prototype;function z(aa,ba){'use strict';u.constructor.call(this,aa);this.$MOverlay1=null;this.shownListeners=null;this.init(ba);}z.prototype.buildWrapper=function(aa,ba){'use strict';this.$MOverlay2=l.create('div',{className:"_5m_s"});var ca=l.create('div',{className:"_5m_t"},ba);this.$MOverlay3=l.create('div',{className:"_5m_u"},[this.$MOverlay2,ca]);if(m.isRTL())this.$MOverlay3.style.direction='rtl';this.$MOverlay4=l.create('div',{className:"_5m_v",sigil:x},this.$MOverlay3);var da=l.create('div',{className:"_5m_w",sigil:'m-overlay-modal blocking-touchable'});return l.create('div',{className:"_5m_x"},[this.$MOverlay4,da]);};z.prototype.getContentRoot=function(){'use strict';return this.$MOverlay3;};z.prototype.show=function(){'use strict';if(this.isShown())return this;u.show.call(this);if(this.isShown()&&!this.shownListeners){this.shownListeners=[r.listen('touchstart',y,this.$MOverlay5.bind(this)),r.listen('touchend',y,this.$MOverlay6.bind(this)),r.listen('m:viewport:orientation-change',null,this.updatePosition.bind(this)),r.listen('focus',y,this.onFocus.bind(this)),r.listen('blur',y,this.onBlur.bind(this))];if(!this.config.suppressScrollHandler)this.shownListeners.push(r.listen('scroll',null,this.onScroll.bind(this)));if(!this.config.suppressTouchMoveHandler)this.shownListeners.push(r.listen('touchmove',x,this.onTouchMove.bind(this)));}return this;};z.prototype.finishHide=function(){'use strict';while(this.shownListeners&&this.shownListeners.length)this.shownListeners.pop().remove();this.shownListeners=null;this.$MOverlay1=null;clearTimeout(this.$MOverlay7);clearInterval(this.$MOverlay8);this.$MOverlay7=null;this.$MOverlay8=null;return u.finishHide.call(this);};z.prototype.updatePosition=function(){'use strict';if(this.$MOverlay9)return;clearInterval(this.$MOverlay8);this.$MOverlay8=null;this.$MOverlay3.style.height=this.getHeight()+'px';this.getRoot().style.top=this.getTop()+'px';clearTimeout(this.$MOverlay10);this.$MOverlay10=null;};z.prototype.getTop=function(){'use strict';return p.getScrollTop();};z.prototype.getHeight=function(){'use strict';var aa=p.getHeight(),ba=v;if(o.IS_APPLE_WEBKIT_IOS&&o.OS_VERSION===7){var ca=p.isLandscape()?screen.availWidth:screen.availHeight,da=ca-aa<=19;ba=da?44:10;if(da)this.$MOverlay8=setInterval(function(){var ea=p.getHeight();if(ea!==aa){clearInterval(this.$MOverlay8);this.$MOverlay8=null;setTimeout(this.updatePosition.bind(this),100);}}.bind(this),500);k.conditionClass(this.getRoot(),"_5rpc",!da);}return aa-w-ba;};z.prototype.onTouchMove=function(aa){'use strict';if(!aa.getNode('tag:textarea')||this.$MOverlay1===null){aa.prevent();}else{var ba=aa.getTarget(),ca=s.getTouchClientCoord(aa).y,da=this.$MOverlay1-ca,ea=ba.scrollHeight-ba.offsetHeight;if(ea<=0||da<0&&q.getTop(ba)<=0||da>0&&q.getTop(ba)>=ea){aa.prevent();}else aa.stop();}};z.prototype.$MOverlay5=function(aa){'use strict';this.$MOverlay1=s.getTouchClientCoord(aa).y;};z.prototype.$MOverlay6=function(aa){'use strict';this.$MOverlay1=null;};z.prototype.onScroll=function(aa){'use strict';clearTimeout(this.$MOverlay10);this.$MOverlay10=h(this.updatePosition.bind(this),100);};z.prototype.onFocus=function(aa){'use strict';this.$MOverlay9=true;};z.prototype.onBlur=function(aa){'use strict';this.$MOverlay9=false;this.updatePosition();this.$MOverlay7=h(this.updatePosition.bind(this),1000);};z.prototype.getUpdatePositionBlocked=function(){'use strict';return this.$MOverlay9;};z.prototype.getInsertParent=function(){'use strict';var aa=this.insertParent;if(!aa)aa=j('page');return aa||u.getInsertParent.call(this);};f.exports=z;},null);